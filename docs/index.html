<!DOCTYPE html>
<html lang="ja">
<head>
  <!-- Google Analytics 4 の計測タグ（測定IDは運用値を使用） -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RS12737WLG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    // SPA ではないため、明示的に page_view の送信制御を維持
    gtag('config', 'G-RS12737WLG', { send_page_view: false });
  </script>
  
  <meta charset="UTF-8" />
  <!-- Step1: title は「ページ名｜サイト名」で統一し、検索結果で役割を明確にする -->
  <title>四国のイベント情報マップ｜イベントガイド【四国版】</title>

  <!-- Step1: description は「対象地域・できること・情報源」を1文で示す -->
  <meta name="description" content="四国全域（香川・愛媛・徳島・高知）の公共施設イベントを地図で探せるページです。開催場所・日程・公式サイト情報をまとめて確認できます。"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css"/>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <!-- Step1: トップページにもパンくずを配置し、全ページで導線仕様を統一する -->
  <nav class="breadcrumb" aria-label="パンくずリスト">
    <ol class="breadcrumb__list">
      <li class="breadcrumb__item" aria-current="page"><span>ホーム</span></li>
    </ol>
  </nav>

  <header class="site-header">
    <!-- 右上固定: 問い合わせ導線を常時表示して、利用者が迷わず連絡できるようにする -->
    <div class="site-header__utility">
      <a
        class="site-header__contact-link"
        href="https://forms.gle/LBczsSnHU9Tdicay9"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="お問い合わせフォームを新しいタブで開く"
      >
        お問い合わせ
      </a>
    </div>

    <!-- 上段: タイトルとサブ見出し（サイトの主旨がすぐ伝わるよう整理） -->
    <h1>イベントガイド【四国版】</h1>
    <!-- 中段: 説明文（信頼感のある語調で補足） -->
    <p class="site-lead">
      四国地方を対象とした、地域イベント集約プロジェクトです！　
    </p>
     <p class="site-lead">
      【掲載範囲拡大中】イベント掲載対象施設を日々更新していきます
     </p>
    <!-- 下段: 日付導線（主CTA） -->
    <section class="spot-actions" aria-label="日付別イベントへのクイックリンク">
      <a class="spot-action-btn" href="date/">日付から探す</a>
      <!-- 施設導線を追加して、日付導線と同じ操作感で遷移できるようにする -->
      <a class="spot-action-btn" href="facility/">エリアから探す</a>
      <!-- 新規導線: 施設名50音順ページへ遷移できるボタンを同列に配置する -->
      <a class="spot-action-btn" href="facility-name/">施設名から探す</a>
    </section>
  </header>

  <main>
    <section class="home-layout" aria-labelledby="map-title">
      <h2 id="map-title" style="display:none;">四国エリア イベント施設マップ</h2>

      <!--
        PCでは「地図 + 本日開催中イベント」を2カラムで表示し、
        地図を見ながらイベント一覧を同時に確認できる導線にする。
      -->
      <div class="map-wrapper">
        <!--
          施設名検索UIは将来の再利用を想定してDOM上には残しつつ、
          現在の要件では地図上に表示しないため hidden で非表示化する。
        -->
        <div class="search-box" hidden aria-hidden="true">
          <div class="search-input-wrapper">
            <input
              type="text"
              id="search-input"
              placeholder="施設名で検索"
              aria-label="施設検索"
            />
            <button id="search-clear" type="button" aria-label="検索をクリア">×</button>
            <ul id="search-suggestions"></ul>
          </div>
        </div>

        <button id="locate-btn" type="button" aria-label="現在地を地図の中心に表示">
          <span class="icon">📍</span>
          <span class="label">現在地</span>
        </button>

        <div id="map"></div>

        <section id="spot-panel" class="spot-panel is-empty" aria-live="polite">
          <div class="spot-panel__body">
            <button id="spot-panel-close" class="spot-panel__close" type="button" aria-label="スポット表示を閉じる">×</button>
            <button id="spot-panel-toggle" class="spot-panel__toggle" type="button" aria-expanded="false" aria-controls="spot-panel-content">
              <div class="spot-panel__kicker">地図上のピンをタップするとイベント情報が表示されます</div>
              <h2 class="spot-panel__title">スポットを選択してください</h2>

              <div class="spot-panel__meta">
                <span id="spot-panel-category" class="spot-panel__chip"></span>
                <span id="spot-panel-area" class="spot-panel__chip"></span>
              </div>
            </button>

            <div id="spot-panel-content" class="spot-panel__content">
              <p id="spot-panel-desc" class="spot-panel__desc"></p>

              <div class="spot-panel__actions">
                <a id="spot-panel-detail" class="btn btn-primary" href="#" target="_self">イベント詳細を見る</a>
                <a id="spot-panel-google" class="btn btn-secondary" href="#" target="_blank" rel="noopener noreferrer">ルート検索</a>
                <a id="spot-panel-official" class="btn btn-tertiary" href="#" target="_blank" rel="noopener noreferrer">公式サイト</a>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!--
        本日開催中イベント: SEO/ユーザビリティのため見出し + リスト構造で実装。
        JSで「本日分のみ・50音順・5件まで」を表示し、超過時は「もっと見る」を出す。
      -->
      <section class="today-events" aria-labelledby="today-events-title">
        <div class="today-events__header">
          <h2 id="today-events-title" class="today-events__title">本日開催中のイベント</h2>
          <p class="today-events__desc">イベント名・県・会場名を表示しています。カードをタップすると地図のピンを強調します。</p>
        </div>

        <p id="today-events-status" class="today-events__status" aria-live="polite">読み込み中です…</p>
        <ul id="today-events-list" class="today-events__list" aria-label="本日開催中イベント一覧"></ul>
        <button id="today-events-more" class="today-events__more" type="button" hidden>もっと見る</button>
      </section>
    </section>
  </main>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script src="js/map.js"></script>

  <footer class="trial-footer">
    © 2026 イベントガイド【四国版】 - 公共施設のイベント情報をお届けします
        <!-- 下段の補足: 試験公開中の注記（控えめに残す） -->
    <p class="site-notice">※本サイトは現在「試験公開中」です。掲載スポット・機能は順次拡充予定です。</p>
  </footer>
</body>
</html>
